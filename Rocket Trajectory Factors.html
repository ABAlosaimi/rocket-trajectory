<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rocket Trajectory Factors</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            color: white;
            min-height: 100vh;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .graph-container {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
            margin-bottom: 20px;
        }
        .prediction-panel {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }
        .factor-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            backdrop-filter: blur(5px);
        }
        .factor-card h3 {
            color: #ffd700;
            margin-top: 0;
        }
        .impact-level {
            display: flex;
            align-items: center;
            margin: 5px 0;
        }
        .impact-bar {
            width: 100px;
            height: 8px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            margin-left: 10px;
            overflow: hidden;
        }
        .impact-fill {
            height: 100%;
            border-radius: 4px;
        }
        .high { background: #ff4444; }
        .medium { background: #ffaa44; }
        .low { background: #44ff44; }
        
        .node {
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .node:hover {
            stroke-width: 3px;
        }
        .link {
            fill: none;
            stroke-width: 2;
            opacity: 0.6;
            transition: opacity 0.3s ease;
        }
        .link:hover {
            opacity: 1;
            stroke-width: 3;
        }
        .node-label {
            font-size: 11px;
            fill: white;
            text-anchor: middle;
            pointer-events: none;
            font-weight: bold;
        }
        .legend {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
        }
        .legend-item {
            display: flex;
            align-items: center;
            margin: 5px 0;
        }
        .legend-color {
            width: 20px;
            height: 3px;
            margin-right: 10px;
            border-radius: 2px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ðŸš€ Rocket Trajectory Prediction System</h1>
            <p>Interactive visualization of interdependent factors affecting rocket accuracy</p>
        </div>

        <div class="graph-container">
            <h2>Factor Interdependency Network</h2>
            <svg id="network-graph" width="100%" height="500"></svg>
            
            <div class="legend">
                <h3>Connection Types:</h3>
                <div class="legend-item">
                    <div class="legend-color" style="background: #ff6b6b;"></div>
                    <span>High Impact Relationship</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #4ecdc4;"></div>
                    <span>Medium Impact Relationship</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #45b7d1;"></div>
                    <span>Low Impact Relationship</span>
                </div>
            </div>
        </div>

        <div class="prediction-panel">
            <div class="factor-card">
                <h3>Primary Trajectory Factors</h3>
                <div class="impact-level">
                    Initial Velocity: <div class="impact-bar"><div class="impact-fill high" style="width: 95%;"></div></div>
                </div>
                <div class="impact-level">
                    Launch Angle: <div class="impact-bar"><div class="impact-fill high" style="width: 90%;"></div></div>
                </div>
                <div class="impact-level">
                    Gravity: <div class="impact-bar"><div class="impact-fill high" style="width: 85%;"></div></div>
                </div>
                <div class="impact-level">
                    Air Resistance: <div class="impact-bar"><div class="impact-fill medium" style="width: 70%;"></div></div>
                </div>
            </div>

            <div class="factor-card">
                <h3>Environmental Variables</h3>
                <div class="impact-level">
                    Wind Speed: <div class="impact-bar"><div class="impact-fill medium" style="width: 65%;"></div></div>
                </div>
                <div class="impact-level">
                    Air Density: <div class="impact-bar"><div class="impact-fill medium" style="width: 55%;"></div></div>
                </div>
                <div class="impact-level">
                    Temperature: <div class="impact-bar"><div class="impact-fill low" style="width: 30%;"></div></div>
                </div>
                <div class="impact-level">
                    Humidity: <div class="impact-bar"><div class="impact-fill low" style="width: 20%;"></div></div>
                </div>
            </div>

            <div class="factor-card">
                <h3>Rocket Characteristics</h3>
                <div class="impact-level">
                    Mass: <div class="impact-bar"><div class="impact-fill high" style="width: 80%;"></div></div>
                </div>
                <div class="impact-level">
                    Shape/Drag Coeff: <div class="impact-bar"><div class="impact-fill medium" style="width: 60%;"></div></div>
                </div>
                <div class="impact-level">
                    Spin Rate: <div class="impact-bar"><div class="impact-fill low" style="width: 40%;"></div></div>
                </div>
                <div class="impact-level">
                    Surface Roughness: <div class="impact-bar"><div class="impact-fill low" style="width: 25%;"></div></div>
                </div>
            </div>

            <div class="factor-card">
                <h3>Prediction Accuracy Methods</h3>
                <p><strong>Ballistic Trajectory:</strong> Basic parabolic path calculation</p>
                <p><strong>Numerical Integration:</strong> Step-by-step simulation accounting for changing conditions</p>
                <p><strong>Monte Carlo Analysis:</strong> Multiple simulations with variable inputs</p>
                <p><strong>Real-time Corrections:</strong> GPS/sensor feedback during flight</p>
            </div>
        </div>
    </div>

    <script>
        // Network graph data
        const nodes = [
            {id: "initial_velocity", name: "Initial\nVelocity", group: 1, x: 200, y: 100},
            {id: "launch_angle", name: "Launch\nAngle", group: 1, x: 100, y: 200},
            {id: "gravity", name: "Gravity", group: 1, x: 300, y: 200},
            {id: "air_resistance", name: "Air\nResistance", group: 2, x: 500, y: 150},
            {id: "wind", name: "Wind\nSpeed", group: 2, x: 400, y: 300},
            {id: "air_density", name: "Air\nDensity", group: 2, x: 600, y: 250},
            {id: "temperature", name: "Temperature", group: 3, x: 700, y: 200},
            {id: "humidity", name: "Humidity", group: 3, x: 650, y: 350},
            {id: "mass", name: "Rocket\nMass", group: 4, x: 200, y: 350},
            {id: "shape", name: "Shape/\nDrag Coeff", group: 4, x: 350, y: 400},
            {id: "target_accuracy", name: "TARGET\nACCURACY", group: 5, x: 400, y: 200}
        ];

        const links = [
            {source: "initial_velocity", target: "target_accuracy", strength: "high", value: 95},
            {source: "launch_angle", target: "target_accuracy", strength: "high", value: 90},
            {source: "gravity", target: "target_accuracy", strength: "high", value: 85},
            {source: "air_resistance", target: "target_accuracy", strength: "medium", value: 70},
            {source: "wind", target: "target_accuracy", strength: "medium", value: 65},
            
            {source: "air_density", target: "air_resistance", strength: "high", value: 80},
            {source: "temperature", target: "air_density", strength: "medium", value: 60},
            {source: "humidity", target: "air_density", strength: "low", value: 30},
            {source: "wind", target: "air_resistance", strength: "medium", value: 50},
            {source: "mass", target: "air_resistance", strength: "medium", value: 55},
            {source: "shape", target: "air_resistance", strength: "high", value: 75},
            
            {source: "temperature", target: "wind", strength: "low", value: 40},
            {source: "mass", target: "gravity", strength: "low", value: 20},
            {source: "initial_velocity", target: "air_resistance", strength: "high", value: 85}
        ];

        // Set up the SVG
        const svg = d3.select("#network-graph");
        const containerWidth = document.querySelector('.graph-container').offsetWidth - 40;
        svg.attr("width", containerWidth).attr("height", 500);

        const width = containerWidth;
        const height = 500;

        // Calculate center offset
        const minX = d3.min(nodes, d => d.x);
        const maxX = d3.max(nodes, d => d.x);
        const minY = d3.min(nodes, d => d.y);
        const maxY = d3.max(nodes, d => d.y);
        const graphWidth = maxX - minX;
        const graphHeight = maxY - minY;
        const offsetX = width / 2 - (minX + graphWidth / 2);
        const offsetY = height / 2 - (minY + graphHeight / 2);

        // Create a group to center the graph
        const g = svg.append("g")
            .attr("transform", `translate(${offsetX},${offsetY})`);

        // Color scale for different groups
        const colorScale = d3.scaleOrdinal()
            .domain([1, 2, 3, 4, 5])
            .range([
                "#FF1744", // Bright Red
                "#00E676", // Bright Green
                "#2979FF", // Bright Blue
                "#FFD600", // Bright Yellow
                "#F500FF"  // Bright Magenta
            ]);

        // Link color scale
        const linkColorScale = d3.scaleOrdinal()
            .domain(["high", "medium", "low"])
            .range(["#ff6b6b", "#4ecdc4", "#45b7d1"]);

        // Create the links
        const link = g.selectAll(".link")
            .data(links)
            .enter().append("line")
            .attr("class", "link")
            .attr("stroke", d => linkColorScale(d.strength))
            .attr("stroke-width", d => d.strength === "high" ? 3 : d.strength === "medium" ? 2 : 1);

        // Create the nodes
        const node = g.selectAll(".node")
            .data(nodes)
            .enter().append("circle")
            .attr("class", "node")
            .attr("r", d => d.id === "target_accuracy" ? 25 : 15)
            .attr("fill", d => colorScale(d.group))
            .attr("stroke", "#fff")
            .attr("stroke-width", 2);

        // Add labels
        const labels = g.selectAll(".node-label")
            .data(nodes)
            .enter().append("text")
            .attr("class", "node-label");

        // Position nodes and links
        function updatePositions() {
            link
                .attr("x1", d => {
                    const source = nodes.find(n => n.id === d.source);
                    return source.x;
                })
                .attr("y1", d => {
                    const source = nodes.find(n => n.id === d.source);
                    return source.y;
                })
                .attr("x2", d => {
                    const target = nodes.find(n => n.id === d.target);
                    return target.x;
                })
                .attr("y2", d => {
                    const target = nodes.find(n => n.id === d.target);
                    return target.y;
                });

            node
                .attr("cx", d => d.x)
                .attr("cy", d => d.y);

            labels
                .attr("x", d => d.x)
                .attr("y", function(d) {
                    // Place label above the node, accounting for multiline
                    const lineCount = (d.name.match(/\n/g) || []).length + 1;
                    // Node radius: 25 for target_accuracy, 15 for others
                    const r = d.id === "target_accuracy" ? 25 : 15;
                    // 16px per line, 8px gap above node
                    return d.y - r - (lineCount - 1) * 8 - 8;
                })
                .attr("text-anchor", "middle")
                .style("dominant-baseline", "alphabetic")
                .each(function(d) {
                    // For multiline names, split and use tspans
                    const lines = d.name.split("\n");
                    d3.select(this)
                        .text(null)
                        .selectAll("tspan")
                        .data(lines)
                        .enter()
                        .append("tspan")
                        .attr("x", d.x)
                        .attr("y", (l, i) => {
                            // Stack lines above the node
                            const r = d.id === "target_accuracy" ? 25 : 15;
                            return d.y - r - (lines.length - 1 - i) * 16 - 8;
                        })
                        .text(l => l);
                });
        }

        updatePositions();

        // Add interactivity
        node.on("mouseover", function(event, d) {
            d3.select(this).attr("r", d.id === "target_accuracy" ? 30 : 20);
            
            // Highlight connected links
            link.style("opacity", l => {
                return (l.source === d.id || l.target === d.id) ? 1 : 0.2;
            });
        })
        .on("mouseout", function(event, d) {
            d3.select(this).attr("r", d.id === "target_accuracy" ? 25 : 15);
            link.style("opacity", 0.6);
        });

        // Add tooltip functionality
        node.append("title")
            .text(d => {
                if (d.id === "target_accuracy") {
                    return "Final target accuracy depends on all connected factors";
                }
                return `${d.name.replace('\n', ' ')}: Affects trajectory through interconnected relationships`;
            });
    </script>
</body>
</html>